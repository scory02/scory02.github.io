import{a7 as e,a,r as t,s as l,h as o,w as i,D as n,c as s,j as r,M as p,k as u,Y as c,Z as d,u as m,S as v,a8 as f,$ as h,b as k,z as y,a0 as j,e as g}from"./@vue-1baf82e9.js";import{A as b}from"./@amap-a03a8b99.js";import M from"./xg-2fe6939b.js";import{b as A}from"./index-ce6d66f0.js";import{M as w}from"./mockjs-7e8f174a.js";import{u as x}from"./vue-router-3b0e2eb8.js";import{_}from"./vue3-splitpane-9ef15b96.js";import{s as C,b as z,w as L,x as P,t as S,y as U,k as q,A as B,h as E,m as O,i as T}from"./naive-ui-1c491db7.js";import"./xgplayer-b2ee90ab.js";import"./xgplayer-hls.js-d019dc6c.js";/* empty css                    */import"./@vueuse-d3e9aa68.js";import"./qrcode-3a4b8256.js";import"./encode-utf8-2ec93547.js";import"./dijkstrajs-b38e4460.js";import"./pinia-0d4f4653.js";import"./echarts-9c2009b0.js";import"./zrender-3ff8857f.js";import"./tslib-a4e99503.js";import"./axios-9a30b300.js";import"./crypto-js-fe439614.js";import"./splitpanes-0469364f.js";import"./@kjgl77-f0f1912f.js";import"./@vicons-a2c8b0eb.js";import"./qs-94839265.js";import"./side-channel-a959ba82.js";import"./get-intrinsic-fee8135b.js";import"./has-symbols-456daba2.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-af191d86.js";import"./object-inspect-89bb0d45.js";import"./lodash-es-fff5457b.js";import"./date-fns-222c3961.js";import"./vueuc-04e5b0aa.js";import"./evtd-2789e4a1.js";import"./seemly-0c71df87.js";import"./@css-render-7ffa2cfa.js";import"./vooks-a437919c.js";import"./vdirs-68b181a5.js";import"./@juggle-80d14552.js";import"./css-render-bd90028a.js";import"./@emotion-b17c1a96.js";import"./treemate-2040dddb.js";import"./async-validator-8d480e59.js";const D={class:"right_box"},F=_({__name:"gmap",setup(_){e((e=>({"5c377cdf":m(Q)})));const F=w.Random,G=A(),I=x(),R="ade7faec217f922d983a664150ba0fe1",W=a({path:[],current_position:[],markerList:[],polylineList:[]}),H=["AMap.CitySearch","AMap.Geolocation","AMap.MoveAnimation","AMap.Autocomplete","AMap.PlaceSearch","AMap.Scale","AMap.OverView","AMap.HawkEye","AMap.ControlBar","AMap.ToolBar","AMap.MapType","AMap.PolyEditor","AMap.CircleEditor","AMap.Geolocation"],J=[{label:"点标记",value:"marker",onclick:ke},{label:"线路",value:"polyline",onclick:e=>{e&&W.path.push(e),function(){const e=new AMap.Polyline({path:W.path,isOutline:!0,outlineColor:"#ffeeff",borderWeight:1,strokeColor:"#3366FF",strokeOpacity:.6,strokeWeight:5,strokeStyle:"solid",lineJoin:"round",lineCap:"round",zIndex:50,showDir:!0});W.polylineList.push(e),K.add(e),ne.value&&ge()}()}}];var K,N;let Y=t("normal"),Q=t("#ffffff"),V=t([]);const X=[];let Z=t(X),$=t(J.filter((e=>e.value==X[0])));const ee=t(null);let ae=t({title:"",textarea:"",video:"",date:""});const te={title:{required:!0,message:"请输入标题"},textarea:{required:!0,message:"请输入内容"}},le=[{label:"添加",key:"add",value:1},{label:"编辑",key:"edit",value:2},{label:"查看",key:"read",value:3}],oe=a({visible:!1,state:"add"}),ie=l((()=>{var e;return(null==(e=le.filter((e=>e.key==oe.state))[0])?void 0:e.label)+"点标记"})),ne=t(!1),se=t(!1),re=t(!1),pe=t(0),ue=t(0);var ce=[{icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-1.png",position:[116.205467,39.907761]},{icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-2.png",position:[116.368904,39.913423]},{icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-3.png",position:[116.305467,39.807761]}];const de=[{label:"路线轨迹",key:"polyline",children:[{label:"轨迹回放",value:"moveAlong",onclick:ge},{label:"清除所有路线",value:"clearAllAlong",onclick:()=>{fe(W.polylineList),W.path=[],W.polylineList=[]}}]},{label:"标记覆盖物",key:"marker",children:[{label:"清除新增标记",value:"clearMap",onclick:()=>{fe(W.markerList),W.markerList=[]}},{label:"清除所有标记",value:"clearAllMap",onclick:fe}]},{label:"主题样式",key:"theme",children:[{label:"标准",value:"normal"},{label:"幻影黑",value:"dark"},{label:"月光银",value:"light"},{label:"远山黛",value:"whitesmoke"},{label:"草色青",value:"fresh"},{label:"雅士灰",value:"grey"},{label:"涂鸦",value:"graffiti"},{label:"马卡龙",value:"macaron"},{label:"靛青蓝",value:"blue"},{label:"极夜蓝",value:"darkblue"},{label:"酱籽",value:"wine"}]}];function me(){b.load({key:R,version:"2.0"}).then((e=>{!function(e){K=new e.Map("gmap",{viewMode:"3D",zoom:10});["amap-logo","amap-copyright"].map((e=>{document.getElementsByClassName(e)[0].remove()})),K.on("complete",(function(){const{lng:e,lat:a}=K.getCenter();var t;V.value=[e,a],ve(),ce.forEach((function(e){new AMap.Marker({map:K,icon:e.icon,position:[e.position[0],e.position[1]],offset:new AMap.Pixel(-13,-30)})})),t=new AMap.Polyline({map:K,strokeColor:"#AF5",strokeWeight:8}),null==N||N.on("moving",(function(e){t.setPath(e.passedPath),se.value&&K.setCenter(e.target.getPosition(),!0)}))})),e.plugin(H,(function(){K.addControl(new e.Scale),K.addControl(new e.ControlBar),K.addControl(new e.MapType),K.addControl(new e.Geolocation)})),K.on("click",(e=>{var a;const{lng:t,lat:l,KL:o,kT:i}=e.lnglat;null==(a=$.value)||a.map((e=>{null==e||e.onclick([t,l])})),W.current_position=[t,l]}))}(e)})).catch((e=>{console.log(e)}))}function ve(){N=new AMap.Marker({map:K,position:null==V?void 0:V.value,icon:"/cxk.gif",offset:new AMap.Pixel(-13,-30)}),W.path.push(null==V?void 0:V.value)}function fe(e){e?null==K||K.remove(e):(null==N||N.stopMove(),null==K||K.clearMap(),N=null,W.markerList=[],W.path=[],W.polylineList=[])}function he(e,a){console.log(a),$.value=a}function ke(e,a="add"){oe.visible=e||!oe.visible,oe.state=a,ae=t({title:F.ctitle(),textarea:F.cparagraph(),video:"",date:F.now()})}function ye(){var e;return null==(e=ee.value)||e.validate((e=>{if(!e)try{!function(e,a){const t=new AMap.Marker({map:K,position:e,icon:F.dataImage("25x34",W.markerList.length),offset:new AMap.Pixel(-13,-30),data:a});t.on("click",je),W.markerList.push(t)}(W.current_position,ae.value)}finally{ke(!1)}})),!1}function je(e){const{data:a}=e.target._originOpts;ke(!0,"read"),ae.value=a}function ge(){var e;N||ve(),(null==(e=W.path)?void 0:e.length)>=2&&(null==N||N.moveAlong(W.path,{duration:500,autoRotation:!0}))}function be(e){var a="amap://styles/"+e;null==K||K.setMapStyle(a)}function Me(e){e.preventDefault();const{clientX:a,clientY:t}=e;pe.value=a,ue.value=t,re.value=!0}function Ae(){re.value=!1}function we(e,a){console.log(a),Ae(),a&&a.onclick?a.onclick():(be(a.value),Y.value=a.value)}function xe(){console.log("销毁"),fe(),null==K||K.destroy(),K=null}return o((()=>{K&&xe(),setTimeout((()=>{me()}),500)})),i(G,(e=>{const a=e.theme?"dark":"normal";Q.value=e.theme?"#18181c":"#ffffff",be(a)})),n((()=>{xe()})),(e,a)=>{const t=C,l=z,o=L,i=P,n=S,b=q,A=B,w=E,x=O,_=T,F=U,G=h("throttle"),R=h("draggable");return k(),s("div",null,[r("div",{id:"gmap",onContextmenu:Me},null,32),p((k(),s("div",D,[u(t,{size:24,type:"success"},{default:c((()=>[y(" 高德地图 ")])),_:1}),p((k(),d(l,{dashed:"",size:"tiny"},{default:c((()=>[y(" 回到首页 ")])),_:1})),[[G,()=>m(I).push("manage")]]),p((k(),d(l,{dashed:"",size:"tiny"},{default:c((()=>[y(" 创建地图 ")])),_:1})),[[G,me]]),p((k(),d(l,{dashed:"",size:"tiny"},{default:c((()=>[y(" 销毁地图 ")])),_:1})),[[G,xe]]),u(o,{multiple:"",size:"tiny",value:m(Z),"onUpdate:value":[a[0]||(a[0]=e=>v(Z)?Z.value=e:Z=e),he],options:J,placeholder:"请选择覆盖物"},null,8,["value"]),u(l,{dashed:"",onClick:a[1]||(a[1]=a=>fe(e.markerList)),size:"tiny"},{default:c((()=>[y(" 清除所有标记 ")])),_:1}),p((k(),d(l,{dashed:"",size:"tiny"},{default:c((()=>[y(" 轨迹回放 ")])),_:1})),[[G,ge]]),u(i,{value:m(ne),"onUpdate:value":a[2]||(a[2]=e=>v(ne)?ne.value=e:null)},{checked:c((()=>[y(" 自动驾驶 ")])),unchecked:c((()=>[y(" 手动驾驶 ")])),_:1},8,["value"]),u(i,{value:m(se),"onUpdate:value":a[3]||(a[3]=e=>v(se)?se.value=e:null)},{checked:c((()=>[y(" 跟随镜头 ")])),unchecked:c((()=>[y(" 不跟随镜头 ")])),_:1},8,["value"]),u(o,{value:m(Y),"onUpdate:value":[a[4]||(a[4]=e=>v(Y)?Y.value=e:Y=e),be],size:"tiny",options:de.filter((e=>"theme"==e.key))[0].children},null,8,["value","options"])])),[[R]]),u(n,{placement:"bottom-start",trigger:"manual",x:m(pe),y:m(ue),options:de,show:m(re),"on-clickoutside":Ae,onSelect:we},null,8,["x","y","show"]),u(F,{show:m(oe).visible,"onUpdate:show":a[7]||(a[7]=e=>m(oe).visible=e),preset:"dialog",title:m(ie)},f({default:c((()=>["read"!==m(oe).state?(k(),d(x,{key:0,ref_key:"formRef",ref:ee,"label-width":80,model:m(ae),rules:te},{default:c((()=>[u(w,{vertical:""},{default:c((()=>[u(A,{label:"标题",path:"title"},{default:c((()=>[u(b,{value:m(ae).title,"onUpdate:value":a[5]||(a[5]=e=>m(ae).title=e),type:"text",placeholder:"请输入标题"},null,8,["value"])])),_:1}),u(A,{label:"内容",path:"textarea"},{default:c((()=>[u(b,{value:m(ae).textarea,"onUpdate:value":a[6]||(a[6]=e=>m(ae).textarea=e),type:"textarea",placeholder:"请输入内容"},null,8,["value"])])),_:1})])),_:1})])),_:1},8,["model"])):(k(),d(_,{key:1,title:m(ae).title,embedded:"",bordered:!1},{"header-extra":c((()=>[y(j(m(ae).date),1)])),default:c((()=>[y(" "+j(m(ae).textarea),1)])),_:1},8,["title"])),"read"==m(oe).state?(k(),d(M,{key:2,url:"https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/byted-player-videos/1.0.0/xgplayer-demo.mp4"})):g("",!0)])),_:2},["read"!==m(oe).state?{name:"action",fn:c((()=>[u(l,{type:"success",size:"small",onClick:ye},{default:c((()=>[y(" 确认 ")])),_:1})])),key:"0"}:void 0]),1032,["show","title"])])}}},[["__scopeId","data-v-93c7b2cf"]]);export{F as default};
